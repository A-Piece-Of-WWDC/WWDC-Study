# Explore App Tracking Transparency

![Untitled](https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/576f8930-12e3-41fb-a5da-ffa9b6f05667)


- 작년부터 생긴 것 같은 이 프롬프트..?
- 회원가입할 때 (선택) 으로 되어있는 약관은 무조건 선택안하는 것 마냥.. 무의식으로 `**앱에 추적 금지 요청**` 눌렀음.
- 뭔지 궁금했었는데 마침 이에 대해 알려주는 짧은 세션이 있길래.. 덥석 보았읍니다.

# **앱 추적 투명성(ATT)**

- 21년 4월 iOS 14.5를 발표하면서 사용자 허락 없이 개인 정보를 추적하는 애플리케이션을 차단할 수 있도록 하는 앱 추적 투명성(ATT)을 적용함
- ****AppTrackingTransparency**** 프레임워크를 도입하여 다른 회사가 소유한 앱 및 웹 사이트에서 앱이 사용자를 추적하기 전에 사용자의 허가를 받도록 요구함
    - 따라서 유저들은 본인들의 의사에 따라 앱의 사용자 정보에 접근 권한을 결정할 수 있고, 사용자의 허락이 없다면 앱은 사용자 정보에 접근 할 수 없음
- 원래는 iOS 14.2부터 도입될 예정이었으나, 페이스북등 광고사들의 항의로 한차례 지연되어 iOS 14.5부터 도입된 기능이라고 합디다..

<img width="1440" alt="스크린샷 2023-05-02 오후 5 29 42" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/fa299e5f-12cf-426e-92f0-8aa318561cdb">


# 추적?

- 추적(traking)이란 `앱에서 수집된 사용자 또는 기기 데이터`를 `**다른 회사**의 웹, 앱사이트, 오프라인 속성에서 수집된 사용자, 기기 데이터`와 연결하여 타게팅 광고, 광고 측정을 수행하는 행위
- 사용자 또는 기기데이터를 `데이터 브로커`와 공유하는 행위도 포함

# 추적이 아닌 경우 1

- `Pal About`이라는 앱을 다운로드했는데, 이 앱은 근처에서 발생하는 장소나 이벤트를 검색하는 기능이 있음
- 와플 파는 곳 검색함
    
    <img width="1117" alt="스크린샷 2023-05-02 오후 5 43 02" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/0a58a8ee-f919-43cd-8aff-97d382ef5185">

    
- `Pal About`은 서버에 나를 **와플 좋아하는 사람**으로 저장
- 나중에, **조식 좋아하는 사람**을 타겟으로 조식 장소를 광고로 보여주려함
- `Pal About`은 내부 검색을 통해 저장한 데이터를 사용해서 나에게 조식 광고를 보여주게 됨
    
    <img width="820" alt="스크린샷 2023-05-02 오후 5 51 44" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/363b5176-d31e-43e4-8a52-b60c3b4cba8c">

    
- **사용자 데이터를 제3자(다른 회사가 소유한 앱이나 웹사이트의 데이터)와 연결하지 않기때문에 추적이 아님**

# 추적이 아닌 경우 2

- `Pal About` 회사에 `Pal about Plus`라는 또 다른 앱이 있다
    
    <img width="1032" alt="스크린샷 2023-05-02 오후 6 01 20" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/ac55c7a9-bb92-4bee-a129-0dc1b23aa4a6">

    
- `Pal about Plus` 은 나를 **타코 좋아하는 사람**으로 저장
- 나중에 `Pal About` 에서 타코 광고 노출
- 이것도 **사용자 데이터를 제3자(다른 회사가 소유한 앱이나 웹사이트의 데이터)와 연결하지 않았기 때문에 추적이 아님**

# 추적인 경우 1 (타사와의 데이터 공유)

- 다른 회사에 `Food Delivery` 앱이 있음
- **밤늦게** 음식을 주문하기 위해 이 앱을 이용함
- 이 앱에 가입할 때 `이메일 주소`를 앱에 제공함
- 이는 `Pal About`에 가입한 이메일과 동일하고 `Pal about Server`에 저장되어있음
- 이 이메일을 사용해서 `Pal About`에서 수집한 와플에 대한 관심과 `Food Delivery` 에서 수집한 밤 늦게 주문한다는 사실을 연결
- 이를 조합하여 `Pal About`에서 24시간 조식을 제공하는 식당 광고 노출
    
    <img width="1085" alt="스크린샷 2023-05-02 오후 6 26 55" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/98d01cee-35aa-4a44-a20c-ca59ad061f92">

    
- `Pal About`에서 추적 허가가 필요함
- `Pal About`의 사용자 데이터인 이메일 주소와 다른 회사 사용자 데이터의 이메일과 야간 주문 습관을 광고목적으로 연결했기 때문
- 식별자의 유형이나 해시 여부는 추적 중이라는 사실에 영향을 끼치지 않으므로 추적 허용이 필요함

### 써드파티 SDK에서 추적 허용이 필요한 경우

- `Pal About` 개발자가 광고 측정 목적으로 앱에 타사 SDK를 포함하려고함
- 추적 허용은 SDK가 `Pal About` 의 사용자 데이터와 다른 회사의 사용자 데이터를 결합하는지 여부에 따라 달라짐
- SDK가 `Pal About` 에서 수집한 데이터를 **타사 데이터와 연결하지 않고** 광고에 대한 분석을 제공하는 경우에는 추적 허용이 필요하지 않음
    
    <img width="846" alt="스크린샷 2023-05-02 오후 6 42 04" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/f044cf3d-33e9-4df3-a353-958b28c048b8">


- 반면에 SDK가 `Pal About` 사용자 데이터를 광고 네트워크와 공유하고
- 그 광고 네트워크가 나의 `Pal About` 사용 데이터를 내가 **다른 회사 앱에서 본 광고**에 대한 데이터와 연결하여 해당 앱에서 광고 효과를 비교하는 경우 추적 허용 필요
- 단순 집계를 보고하는 것 만으로도 추적으로 간주됨

<img width="1334" alt="스크린샷 2023-05-02 오후 6 48 15" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/52575421-2b24-4eac-b1e7-b029927f115d">



- 사용하려는 SDK의 ATT 적용 여부는 직접 문의해야함

# 추적인 경우 2 (데이터 브로커와 공유)

- 사용자 또는 기기 데이터를 브로커와 공유하는 경우
- 국가마다 다르긴하지만 일반적으로 데이터 브로커는 라이선스를 정기적으로 수집하여 판매하거나, 비즈니스와 직접적인 관계가 없는 특정 사용자의 개인 정보를 제3자에게 공개하는 회사를 의미
- 와플에 대한 내 관심사를 데이터 **브로커에게 공유하는 것 자체**만으로도 추적으로 간주됨
- 공유된 데이터가 다른 회사의 데이터와 연결되는지랑 무관함

<img width="1075" alt="스크린샷 2023-05-02 오후 6 59 37" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/62c2acde-710e-4559-b3cb-49befffbc7d3">
<img width="1005" alt="스크린샷 2023-05-02 오후 6 56 58" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/e4ad8ef8-9900-4118-ab8b-2cf43818e1a8">



- 기기가 직접 데이터 브로커와 통신하지 않더라도, 서버를 통해 나중에 전달된다 하더라도 이는 추적으로 간주
- 어떤 목적이든 데이터 브로커에게 데이터를 제공하려면 추적 허용이 필요함

# 추적 허용 요청

- `requestTrackingAuthorization` 메서드를 호출해서 추적 승인 요청 프롬프트를 표시
    <img width="1383" alt="스크린샷 2023-05-02 오후 7 01 43" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/d8f35aff-e896-4fa5-b515-ca7581fd712e">


    - 메서드를 호출하면 시스템 허용 얼럿 발생
    - 일회성이라 시스템은 사용자의 선택을 기억하고 다시 묻지않음 (삭제 후 재설치하는 경우 제외)
- info.plist에 `NSUserTrackingUsageDescription` 키 추가
    
    <img width="364" alt="스크린샷 2023-05-02 오후 7 07 33" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/5e2707c2-16c9-4605-b563-f08e19f2524d">

    
    - 이 문자열이 여기 들어간다. 이거 안넣으면 프롬프트 열릴 때 충돌난다.
    - 앱 이름 위에서 나오니까 밑에서 다시 말하지 마라
- `trackingAuthorizationStatus`을 사용해서 사용자의 앱 추적 허용 상태를 알 수 있음
    - 사용자는 언제든지 추적 허용 상태를 변경할 수 있으니 실행될 때마다 확인해야함

- 같은 회사 각 다른 앱에 추적이 필요하다면 당연히 각각 요청해야됨
    - 추적 상태 공유하지 않음
    <img width="973" alt="스크린샷 2023-05-02 오후 7 19 23" src="https://github.com/A-Piece-Of-WWDC/WWDC-Study/assets/70168249/ed2f42ca-25b7-4ac8-bd5f-73bb14cab45e">


# 사용자가 추적을 거부하는 경우

- 앱의 기능을 제한하면 안됨
- IDAF API는 모두 0을 반환함
    - 이게뭐야? `ID for Advertisers` 광고 식별자입니다.

# **더 이상의 핑거프린팅은 없다**

- 사용자가 허용하면 추적은 허용되지만 핑거프린팅 방식의 데이터 수집은 절대 허용되지 않음
    - **디바이스 정보를 기반으로 지속되고 고유한 ID를 생성하여, 유저를 여러 웹사이트에서 트래킹하는 방법.**
    - 사용자의 웹 브라우저 configuration, 기기 configuration, 사용자 위치, 네트워크 연결 속성 등 …
- **더 이상 데이터를 트래킹하는 서드파티 플랫폼에서 핑거프린팅 방식의 데이터 수집을 허용하지 않겠다는 것**이 Apple의 방침
    - 2021년 4월 글로벌 MMP 중 하나인 Adjust의 SDK가 삽입된 iOS 앱들이 줄줄이 [App Store에서 심사 거부를 당하는 일](https://www.forbes.com/sites/johnkoetsier/2021/04/01/apple-rejecting-apps-with-fingerprinting-enabled-as-ios-14-privacy-enforcement-starts/?sh=56a290ac3d19)이 있었다. 모바일 마케팅 전문가 Eric Seufert는 이 사태에 대해 ‘*Adjust SDK의 핑거프린팅 데이터 수집이 원인*’이라고 언급. 곧바로 Adjust는 SDK 코드 수정 및 시정 조치에 나섰지만 위 사건이 애드테크 업계에 주는 파장은 상당했음
    - 이는 **더 이상 iOS 생태계에서는 유저의 동의 없이는 그 어떤 유저 레벨의 데이터를 수집할 수 없음**을 시사
- **Apple은 유저 레벨의 데이터 수집을 위해 SKAdNetwork이라는 대안을 제시함.**
- SKAdNetwork 프레임워크에서 전송하는 **익명화된 데이터를 수집하여 어트리뷰션 여부와 유저의 특성을 파악**할 수 있다.
